{"version":3,"file":"useFocusManager.js","sources":["../../../../src/use/useFocusManager.ts"],"sourcesContent":["import useId from './useId';\nimport {\n  type Ref,\n  inject,\n  ref,\n  computed,\n  watchEffect,\n  onUnmounted,\n} from 'vue';\n\ninterface Options {\n  trapping: boolean;\n}\ninterface FocusManagerContextType {\n  trapFocusList: Ref<string[]>;\n  add: (id: string) => void;\n  remove: (id: string) => boolean;\n}\n\nexport function useFocusManager({ trapping }: Options) {\n  const context = inject<FocusManagerContextType>('focus-manager');\n  const id = useId();\n\n  if (!context) {\n    throw new Error('No FocusManager was provided.');\n  }\n\n  const {\n    trapFocusList,\n    add: addFocusItem,\n    remove: removeFocusItem,\n  } = context; \n\n  const canSafelyFocus = computed(() => trapFocusList.value[0] === String(id));\n\n  watchEffect(() => {\n    if (!trapping) {\n      return;\n    }\n\n    addFocusItem(String(id));\n  });\n\n  onUnmounted(() => {\n    removeFocusItem(String(id));\n  });\n\n  return { canSafelyFocus };\n}\n\nexport function useFocusManagerContext(): FocusManagerContextType {\n  const trapFocusList = ref<string[]>([]);\n\n  const add = (id: string) => {\n    trapFocusList.value = [...trapFocusList.value, id];\n  };\n\n  const remove = (id: string) => {\n    let removed = true;\n\n    const clone = [...trapFocusList.value];\n    const index = clone.indexOf(id);\n\n    if (index === -1) {\n      removed = false;\n    } else {\n      clone.splice(index, 1);\n    }\n\n    trapFocusList.value = clone;\n\n    return removed;\n  };\n\n  return {\n    add,\n    remove,\n    trapFocusList,\n  }\n}\n"],"names":[],"mappings":";;AAmBgB,SAAA,gBAAgB,EAAE,YAAqB;AAC/C,QAAA,UAAU,OAAgC,eAAe;AAC/D,QAAM,KAAK;AAEX,MAAI,CAAC,SAAS;AACN,UAAA,IAAI,MAAM,+BAA+B;AAAA,EACjD;AAEM,QAAA;AAAA,IACJ;AAAA,IACA,KAAK;AAAA,IACL,QAAQ;AAAA,EACN,IAAA;AAEE,QAAA,iBAAiB,SAAS,MAAM,cAAc,MAAM,CAAC,MAAM,OAAO,EAAE,CAAC;AAE3E,cAAY,MAAM;AAChB,QAAI,CAAC,UAAU;AACb;AAAA,IACF;AAEa,iBAAA,OAAO,EAAE,CAAC;AAAA,EAAA,CACxB;AAED,cAAY,MAAM;AACA,oBAAA,OAAO,EAAE,CAAC;AAAA,EAAA,CAC3B;AAED,SAAO,EAAE,eAAe;AAC1B;AAEO,SAAS,yBAAkD;AAC1D,QAAA,gBAAgB,IAAc,CAAA,CAAE;AAEhC,QAAA,MAAM,CAAC,OAAe;AAC1B,kBAAc,QAAQ,CAAC,GAAG,cAAc,OAAO,EAAE;AAAA,EAAA;AAG7C,QAAA,SAAS,CAAC,OAAe;AAC7B,QAAI,UAAU;AAEd,UAAM,QAAQ,CAAC,GAAG,cAAc,KAAK;AAC/B,UAAA,QAAQ,MAAM,QAAQ,EAAE;AAE9B,QAAI,UAAU,IAAI;AACN,gBAAA;AAAA,IAAA,OACL;AACC,YAAA,OAAO,OAAO,CAAC;AAAA,IACvB;AAEA,kBAAc,QAAQ;AAEf,WAAA;AAAA,EAAA;AAGF,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;"}