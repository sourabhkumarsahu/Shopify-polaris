{"version":3,"file":"Sticky.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../src/components/Sticky/Sticky.vue"],"sourcesContent":["<template lang=\"pug\">\ndiv\n  div(ref=\"placeHolderNode\")\n  div(ref=\"stickyNode\", :style=\"style\")\n    slot\n</template>\n\n<script setup lang=\"ts\">\nimport { type VNode, ref, onMounted, onBeforeUnmount, onUpdated } from 'vue';\nimport useStickyManager from '@/use/useStickyManager';\nimport { getRectForNode } from '@/utilities/geometry';\nimport type { VueNode } from '@/utilities/types';\n\nexport type StickyProps = {\n  /** Element outlining the fixed position boundaries */\n  boundingElement?: HTMLElement | null;\n  /** Offset vertical spacing from the top of the scrollable container */\n  offset?: boolean;\n  /** Should the element remain in a fixed position when the layout is stacked (smaller screens)  */\n  disableWhenStacked?: boolean;\n};\n\nconst props = defineProps<StickyProps>();\nconst emits = defineEmits<{\n  'sticky-change': [isSticky: boolean],\n}>();\nconst slots = defineSlots<{\n  default?: (_?: VueNode) => VNode[];\n}>();\n\n\nconst stickyManager = useStickyManager();\n\nconst isSticky = ref(false);\nconst style = ref({});\nconst placeHolderNode = ref<HTMLElement | null>(null);\nconst stickyNode = ref<HTMLElement | null>(null);\n\nonMounted(() => {\n  if (!stickyNode.value || !placeHolderNode.value) {\n    return;\n  }\n\n  stickyManager.value.registerStickyItem({\n    stickyNode: stickyNode.value,\n    placeHolderNode: placeHolderNode.value,\n    handlePositioning: handlePositioning,\n    offset: props.offset,\n    boundingElement: props.boundingElement,\n    disableWhenStacked: props.disableWhenStacked,\n  });\n});\n\nonBeforeUnmount(() => {\n  if (!stickyNode.value) {\n    return;\n  }\n\n  stickyManager.value.unregisterStickyItem(stickyNode.value);\n});\n\nconst handlePositioning = (\n  stick: boolean,\n  top = 0,\n  left = 0,\n  width = 0,\n) => {\n  if ((stick && !isSticky.value) || (!stick && isSticky.value)) {\n    isSticky.value = !isSticky.value;\n\n    emits('sticky-change', !isSticky.value);\n\n    if (!props.boundingElement) {\n      return;\n    }\n\n    adjustPlaceHolderNode(stick);\n\n    props.boundingElement.toggleAttribute('data-sticky-active');\n  }\n  style.value = stick\n    ? {\n      position: 'fixed',\n      top: `${top}px`,\n      left: `${left}px`,\n      width: `${width}px`,\n    }\n    : {};\n};\n\nconst adjustPlaceHolderNode = (add: boolean) => {\n  if (placeHolderNode.value && stickyNode.value) {\n    placeHolderNode.value.style.paddingBottom = add\n      ? `${getRectForNode(stickyNode.value).height}px`\n      : '0px';\n  }\n};\n\nconst updateComponent = () => {\n  const {\n    boundingElement,\n    offset,\n    disableWhenStacked,\n  } = props;\n\n  if (!stickyNode.value || !placeHolderNode.value) return;\n\n  const stickyManagerItem = stickyManager.value.getStickyItem(stickyNode.value);\n  const didPropsChange =\n    !stickyManagerItem ||\n    boundingElement !== stickyManagerItem.boundingElement ||\n    offset !== stickyManagerItem.offset ||\n    disableWhenStacked !== stickyManagerItem.disableWhenStacked;\n\n  if (!didPropsChange) return;\n\n  stickyManager.value.unregisterStickyItem(stickyNode.value);\n  stickyManager.value.registerStickyItem({\n    stickyNode: stickyNode.value,\n    placeHolderNode: placeHolderNode.value,\n    handlePositioning: handlePositioning,\n    offset,\n    boundingElement,\n    disableWhenStacked,\n  });\n};\n\nonUpdated(() => {\n  updateComponent();\n});\n</script>\n"],"names":["_useSlots"],"mappings":";;;;;;;;;;;;AAsBA,UAAM,QAAQ;AACd,UAAM,QAAQ;AAGAA;AAKd,UAAM,gBAAgB;AAEhB,UAAA,WAAW,IAAI,KAAK;AACpB,UAAA,QAAQ,IAAI,CAAA,CAAE;AACd,UAAA,kBAAkB,IAAwB,IAAI;AAC9C,UAAA,aAAa,IAAwB,IAAI;AAE/C,cAAU,MAAM;AACd,UAAI,CAAC,WAAW,SAAS,CAAC,gBAAgB,OAAO;AAC/C;AAAA,MACF;AAEA,oBAAc,MAAM,mBAAmB;AAAA,QACrC,YAAY,WAAW;AAAA,QACvB,iBAAiB,gBAAgB;AAAA,QACjC;AAAA,QACA,QAAQ,MAAM;AAAA,QACd,iBAAiB,MAAM;AAAA,QACvB,oBAAoB,MAAM;AAAA,MAAA,CAC3B;AAAA,IAAA,CACF;AAED,oBAAgB,MAAM;AAChB,UAAA,CAAC,WAAW,OAAO;AACrB;AAAA,MACF;AAEc,oBAAA,MAAM,qBAAqB,WAAW,KAAK;AAAA,IAAA,CAC1D;AAEK,UAAA,oBAAoB,CACxB,OACA,MAAM,GACN,OAAO,GACP,QAAQ,MACL;AACH,UAAK,SAAS,CAAC,SAAS,SAAW,CAAC,SAAS,SAAS,OAAQ;AACnD,iBAAA,QAAQ,CAAC,SAAS;AAErB,cAAA,iBAAiB,CAAC,SAAS,KAAK;AAElC,YAAA,CAAC,MAAM,iBAAiB;AAC1B;AAAA,QACF;AAEA,8BAAsB,KAAK;AAErB,cAAA,gBAAgB,gBAAgB,oBAAoB;AAAA,MAC5D;AACA,YAAM,QAAQ,QACV;AAAA,QACA,UAAU;AAAA,QACV,KAAK,GAAG,GAAG;AAAA,QACX,MAAM,GAAG,IAAI;AAAA,QACb,OAAO,GAAG,KAAK;AAAA,UAEf;IAAC;AAGD,UAAA,wBAAwB,CAAC,QAAiB;AAC1C,UAAA,gBAAgB,SAAS,WAAW,OAAO;AAC7B,wBAAA,MAAM,MAAM,gBAAgB,MACxC,GAAG,eAAe,WAAW,KAAK,EAAE,MAAM,OAC1C;AAAA,MACN;AAAA,IAAA;AAGF,UAAM,kBAAkB,MAAM;AACtB,YAAA;AAAA,QACJ;AAAA,QACA;AAAA,QACA;AAAA,MACE,IAAA;AAEJ,UAAI,CAAC,WAAW,SAAS,CAAC,gBAAgB,MAAO;AAEjD,YAAM,oBAAoB,cAAc,MAAM,cAAc,WAAW,KAAK;AACtE,YAAA,iBACJ,CAAC,qBACD,oBAAoB,kBAAkB,mBACtC,WAAW,kBAAkB,UAC7B,uBAAuB,kBAAkB;AAE3C,UAAI,CAAC,eAAgB;AAEP,oBAAA,MAAM,qBAAqB,WAAW,KAAK;AACzD,oBAAc,MAAM,mBAAmB;AAAA,QACrC,YAAY,WAAW;AAAA,QACvB,iBAAiB,gBAAgB;AAAA,QACjC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MAAA,CACD;AAAA,IAAA;AAGH,cAAU,MAAM;AACE;IAAA,CACjB;;;;;;;;;;;;;;;;;;"}