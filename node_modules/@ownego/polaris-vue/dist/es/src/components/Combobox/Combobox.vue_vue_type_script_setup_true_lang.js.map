{"version":3,"file":"Combobox.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../src/components/Combobox/Combobox.vue"],"sourcesContent":["<template lang=\"pug\">\nPopover(\n  ref=\"popoverRef\",\n  :active=\"popoverActiveWithChildren\",\n  autofocus-target=\"none\",\n  prevent-focus-on-close,\n  full-width,\n  :prefer-input-activator=\"false\",\n  :preferred-position=\"preferredPosition\",\n  @close=\"handleClose\",\n)\n  template(#activator)\n    slot(name=\"activator\")\n\n  Pane(\n    v-if=\"hasSlot(slots.default)\",\n    :height=\"height\",\n    :max-height=\"maxHeight\",\n    :min-height=\"minHeight\",\n    @scrolled-to-bottom=\"onScrolledToBottom\",\n  )\n    div(:class=\"styles.Listbox\")\n      slot\n</template>\n\n<script setup lang=\"ts\">\nimport { type VNode, ref, computed, provide } from 'vue';\nimport { Popover, type PopoverProps, Pane } from '@/components';\nimport type { VueNode, ComboboxListboxType } from '@/utilities/types';\nimport type { ComboboxListboxOptionType } from '@/use/useListbox';\nimport { useHasSlot } from '@/use/useHasSlot';\n\nimport styles from '@polaris/components/Combobox/Combobox.module.css';\nimport type { ComboboxTextFieldType } from './context';\n\nexport type ComboboxProps = {\n  /** Allows more than one option to be selected */\n  allowMultiple?: boolean;\n  /**\n   * The preferred direction to open the popover\n   * @default 'below'\n  */\n  preferredPosition?: PopoverProps['preferredPosition'];\n  /** Whether or not more options are available to lazy load when the bottom of the listbox reached. Use the hasMoreResults boolean provided by the GraphQL API of the paginated data. */\n  willLoadMoreOptions?: boolean;\n  /** Height to set on the Popover Pane. */\n  height?: string;\n  /** Callback fired when the bottom of the listbox is reached. Use to lazy load when listbox option data is paginated. */\n  maxHeight?: string;\n  /** Min Height to set on the Popover Pane. */\n  minHeight?: string;\n};\n\ntype ComboboxSlots = {\n  /** The content to display inside the popover */\n  default: (_?: VueNode) => VNode[];\n  /** The text field component to activate the Popover */\n  activator: (_?: VueNode) => VNode[];\n};\n\ntype ComboboxEvents = {\n  /** Callback fired when the bottom of the lisbox is reached. Use to lazy load when listbox option data is paginated. */\n  'scrolled-to-bottom': [];\n  /** Callback fired when the popover closes */\n  'close': [];\n}\n\nconst props = withDefaults(defineProps<ComboboxProps>(), {\n  preferredPosition: 'below',\n});\nconst slots = defineSlots<ComboboxSlots>();\nconst emits = defineEmits<ComboboxEvents>();\n\nconst { hasSlot } = useHasSlot();\n\nconst popoverRef = ref<InstanceType<typeof Popover> | null>();\nconst popoverActive = ref(false);\nconst activeOptionId = ref<string>();\nconst textFieldLabelId = ref<string>();\nconst listboxId = ref<string>();\nconst textFieldFocused = ref(false);\n\nconst shouldOpen = computed(() => !popoverActive.value);\n\nconst popoverActiveWithChildren = computed(() => popoverActive.value && hasSlot(slots.default));\nconst isWillLoadMoreOptions = computed(() => Boolean(props.willLoadMoreOptions));\n\nconst setTextFieldFocused = (focused: boolean) => {\n  textFieldFocused.value = focused;\n};\n\nconst setTextFieldLabelId = (id: string) => {\n  textFieldLabelId.value = id;\n};\n\nconst setActiveOptionId = (id: string) => {\n  activeOptionId.value = id;\n};\n\nconst setListboxId = (id: string) => {\n  listboxId.value = id;\n};\n\nconst handleClose = () => {\n  popoverActive.value = false;\n  emits('close');\n\n  activeOptionId.value = undefined;\n};\n\nconst handleOpen = () => {\n  popoverActive.value = true;\n  activeOptionId.value = undefined;\n};\n\nconst onOptionSelected = () => {\n  if (!props.allowMultiple) {\n    handleClose();\n    return;\n  }\n\n  popoverRef.value?.forceUpdatePosition();\n};\n\nconst handleFocus = () => {\n  if (shouldOpen.value) {\n    handleOpen();\n  }\n};\n\nconst handleChange = () => {\n  if (shouldOpen.value) {\n    handleOpen();\n  }\n};\n\nconst handleBlur = () => {\n  if (popoverActive.value) {\n    handleClose();\n  }\n};\n\nconst onScrolledToBottom = () => {\n  emits('scrolled-to-bottom');\n};\n\nprovide<ComboboxTextFieldType>('combobox-textfield', {\n  activeOptionId,\n  listboxId,\n  expanded: popoverActive,\n  setTextFieldFocused,\n  setTextFieldLabelId,\n  onTextFieldFocus: handleFocus,\n  onTextFieldChange: handleChange,\n  onTextFieldBlur: handleBlur,\n});\n\nprovide<ComboboxListboxType>('combobox-listbox', {\n  listboxId,\n  textFieldLabelId,\n  textFieldFocused,\n  willLoadMoreOptions: isWillLoadMoreOptions,\n  onOptionSelected,\n  setActiveOptionId,\n  setListboxId,\n  onKeyToBottom: onScrolledToBottom,\n});\n\nprovide<ComboboxListboxOptionType>('combobox-listbox-option', {\n  allowMultiple: props.allowMultiple,\n});\n</script>\n"],"names":["_useSlots"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAmEA,UAAM,QAAQ;AAGd,UAAM,QAAQA;AACd,UAAM,QAAQ;AAER,UAAA,EAAE,YAAY;AAEpB,UAAM,aAAa;AACb,UAAA,gBAAgB,IAAI,KAAK;AAC/B,UAAM,iBAAiB;AACvB,UAAM,mBAAmB;AACzB,UAAM,YAAY;AACZ,UAAA,mBAAmB,IAAI,KAAK;AAElC,UAAM,aAAa,SAAS,MAAM,CAAC,cAAc,KAAK;AAEhD,UAAA,4BAA4B,SAAS,MAAM,cAAc,SAAS,QAAQ,MAAM,OAAO,CAAC;AAC9F,UAAM,wBAAwB,SAAS,MAAM,QAAQ,MAAM,mBAAmB,CAAC;AAEzE,UAAA,sBAAsB,CAAC,YAAqB;AAChD,uBAAiB,QAAQ;AAAA,IAAA;AAGrB,UAAA,sBAAsB,CAAC,OAAe;AAC1C,uBAAiB,QAAQ;AAAA,IAAA;AAGrB,UAAA,oBAAoB,CAAC,OAAe;AACxC,qBAAe,QAAQ;AAAA,IAAA;AAGnB,UAAA,eAAe,CAAC,OAAe;AACnC,gBAAU,QAAQ;AAAA,IAAA;AAGpB,UAAM,cAAc,MAAM;AACxB,oBAAc,QAAQ;AACtB,YAAM,OAAO;AAEb,qBAAe,QAAQ;AAAA,IAAA;AAGzB,UAAM,aAAa,MAAM;AACvB,oBAAc,QAAQ;AACtB,qBAAe,QAAQ;AAAA,IAAA;AAGzB,UAAM,mBAAmB,MAAM;;AACzB,UAAA,CAAC,MAAM,eAAe;AACZ;AACZ;AAAA,MACF;AAEA,uBAAW,UAAX,mBAAkB;AAAA,IAAoB;AAGxC,UAAM,cAAc,MAAM;AACxB,UAAI,WAAW,OAAO;AACT;MACb;AAAA,IAAA;AAGF,UAAM,eAAe,MAAM;AACzB,UAAI,WAAW,OAAO;AACT;MACb;AAAA,IAAA;AAGF,UAAM,aAAa,MAAM;AACvB,UAAI,cAAc,OAAO;AACX;MACd;AAAA,IAAA;AAGF,UAAM,qBAAqB,MAAM;AAC/B,YAAM,oBAAoB;AAAA,IAAA;AAG5B,YAA+B,sBAAsB;AAAA,MACnD;AAAA,MACA;AAAA,MACA,UAAU;AAAA,MACV;AAAA,MACA;AAAA,MACA,kBAAkB;AAAA,MAClB,mBAAmB;AAAA,MACnB,iBAAiB;AAAA,IAAA,CAClB;AAED,YAA6B,oBAAoB;AAAA,MAC/C;AAAA,MACA;AAAA,MACA;AAAA,MACA,qBAAqB;AAAA,MACrB;AAAA,MACA;AAAA,MACA;AAAA,MACA,eAAe;AAAA,IAAA,CAChB;AAED,YAAmC,2BAA2B;AAAA,MAC5D,eAAe,MAAM;AAAA,IAAA,CACtB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}