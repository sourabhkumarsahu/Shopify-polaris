{"version":3,"file":"Resizer.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../../src/components/TextField/components/Resizer/Resizer.vue"],"sourcesContent":["<template lang=\"pug\">\ndiv(\n  aria-hidden,\n  :class=\"styles.Resizer\",\n)\n  div(\n    ref=\"contentNode\",\n    :class=\"styles.DummyInput\",\n    v-html=\"finalContents\",\n  )\n  div(\n    v-if=\"minimumLines\",\n    ref=\"minimumLinesNode\",\n    :class=\"styles.DummyInput\",\n    v-html=\"contentsForMinimumLines\",\n  )\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from 'vue';\nimport { useEventListener } from '@/utilities/use-event-listener';\nimport styles from '@polaris/components/TextField/TextField.module.css';\n\nexport type ResizerProps = {\n  contents?: string;\n  currentHeight?: number | null;\n  minimumLines?: number;\n  onHeightChange(height: number): void;\n};\n\ntype ResizerEvents = {\n  'height-change': [height: number];\n}\n\nconst props = defineProps<ResizerProps>();\n\nconst emits = defineEmits<ResizerEvents>();\n\nconst contentNode = ref<HTMLDivElement | null>(null);\nconst minimumLinesNode = ref<HTMLDivElement | null>(null);\nconst animationFrame = ref<number>();\nconst currentHeight = ref<number | null>(props.currentHeight ?? null);\n\nif (props.currentHeight !== currentHeight.value) {\n  currentHeight.value = props.currentHeight || null;\n}\n\nconst finalContents = computed(() => {\n  return props.contents\n    ? `${props.contents.replace(REPLACE_REGEX, replaceEntity)}<br>`\n    : '<br>';\n});\n\nconst contentsForMinimumLines = computed(() => {\n  if (!props.minimumLines) return '';\n  let content = '';\n\n  for (let line = 0; line < props.minimumLines; line++) {\n    content += '<br>';\n  }\n\n  return content;\n});\n\nonMounted(() => {\n  useEventListener('resize', handleHeightCheck);\n\n  if (animationFrame.value) {\n    cancelAnimationFrame(animationFrame.value);\n  }\n});\n\nconst handleHeightCheck = () => {\n  if (animationFrame.value) {\n    cancelAnimationFrame(animationFrame.value);\n  }\n\n  animationFrame.value = requestAnimationFrame(() => {\n    if (!contentNode.value || !minimumLinesNode.value) {\n      return;\n    }\n\n    const newHeight = Math.max(\n      contentNode.value.offsetHeight,\n      minimumLinesNode.value.offsetHeight,\n    );\n\n    if (newHeight !== currentHeight.value) {\n      emits('height-change', newHeight);\n    }\n  });\n};\n\nconst ENTITIES_TO_REPLACE = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\\n': '<br>',\n  '\\r': '',\n};\n\nconst REPLACE_REGEX = new RegExp(\n  `[${Object.keys(ENTITIES_TO_REPLACE).join()}]`,\n  'g',\n);\n\nfunction replaceEntity(entity: string) {\n  return ENTITIES_TO_REPLACE[entity as keyof typeof ENTITIES_TO_REPLACE];\n}\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAkCA,UAAM,QAAQ;AAEd,UAAM,QAAQ;AAER,UAAA,cAAc,IAA2B,IAAI;AAC7C,UAAA,mBAAmB,IAA2B,IAAI;AACxD,UAAM,iBAAiB;AACvB,UAAM,gBAAgB,IAAmB,MAAM,iBAAiB,IAAI;AAEhE,QAAA,MAAM,kBAAkB,cAAc,OAAO;AACjC,oBAAA,QAAQ,MAAM,iBAAiB;AAAA,IAC/C;AAEM,UAAA,gBAAgB,SAAS,MAAM;AAC5B,aAAA,MAAM,WACT,GAAG,MAAM,SAAS,QAAQ,eAAe,aAAa,CAAC,SACvD;AAAA,IAAA,CACL;AAEK,UAAA,0BAA0B,SAAS,MAAM;AACzC,UAAA,CAAC,MAAM,aAAqB,QAAA;AAChC,UAAI,UAAU;AAEd,eAAS,OAAO,GAAG,OAAO,MAAM,cAAc,QAAQ;AACzC,mBAAA;AAAA,MACb;AAEO,aAAA;AAAA,IAAA,CACR;AAED,cAAU,MAAM;AACd,uBAAiB,UAAU,iBAAiB;AAE5C,UAAI,eAAe,OAAO;AACxB,6BAAqB,eAAe,KAAK;AAAA,MAC3C;AAAA,IAAA,CACD;AAED,UAAM,oBAAoB,MAAM;AAC9B,UAAI,eAAe,OAAO;AACxB,6BAAqB,eAAe,KAAK;AAAA,MAC3C;AAEe,qBAAA,QAAQ,sBAAsB,MAAM;AACjD,YAAI,CAAC,YAAY,SAAS,CAAC,iBAAiB,OAAO;AACjD;AAAA,QACF;AAEA,cAAM,YAAY,KAAK;AAAA,UACrB,YAAY,MAAM;AAAA,UAClB,iBAAiB,MAAM;AAAA,QAAA;AAGrB,YAAA,cAAc,cAAc,OAAO;AACrC,gBAAM,iBAAiB,SAAS;AAAA,QAClC;AAAA,MAAA,CACD;AAAA,IAAA;AAGH,UAAM,sBAAsB;AAAA,MAC1B,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,MAAM;AAAA,MACN,MAAM;AAAA,IAAA;AAGR,UAAM,gBAAgB,IAAI;AAAA,MACxB,IAAI,OAAO,KAAK,mBAAmB,EAAE,KAAM,CAAA;AAAA,MAC3C;AAAA,IAAA;AAGF,aAAS,cAAc,QAAgB;AACrC,aAAO,oBAAoB,MAA0C;AAAA,IACvE;;;;;;;;;;;;;;;;;;;;;;;"}