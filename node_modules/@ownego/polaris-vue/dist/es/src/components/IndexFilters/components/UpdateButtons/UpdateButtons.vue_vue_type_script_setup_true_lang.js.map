{"version":3,"file":"UpdateButtons.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../../src/components/IndexFilters/components/UpdateButtons/UpdateButtons.vue"],"sourcesContent":["<template lang=\"pug\">\nInlineStack(\n  align=\"start\",\n  block-align=\"center\",\n  gap=\"100\",\n)\n  Button(\n    v-if=\"cancelAction\",\n    size=\"micro\",\n    variant=\"tertiary\",\n    :disabled=\"disabled\",\n    @click=\"cancelAction.onAction\",\n  ) {{ i18n.translate('Polaris.IndexFilters.UpdateButtons.cancel') }}\n  template(v-if=\"primaryAction?.type === 'save-as'\")\n    Modal(\n      :open=\"savedViewModalOpen\",\n      :primaryAction=\"primaryModalAction\",\n      :secondaryActions=\"secondaryModalActions\",\n    )\n      template(#title) {{ i18n.translate('Polaris.IndexFilters.UpdateButtons.modal.title') }}\n      template(#activator)\n        InlineStack\n          Button(\n            size=\"micro\",\n            :disabled=\"primaryAction?.disabled || disabled\",\n            @click=\"handleClickSaveButton\",\n          ) {{ buttonText }}\n      ModalSection\n        Form(@submit=\"handlePrimaryAction\")\n          FormLayout\n            div(ref=\"container\")\n              TextField(\n                v-model=\"savedViewName\",\n                show-character-count,\n                auto-complete=\"off\",\n                :disabled=\"disabled\",\n                :max-length=\"MAX_VIEW_NAME_LENGTH\",\n                :label=\"i18n.translate('Polaris.IndexFilters.UpdateButtons.modal.label')\",\n                :error=\"hasSameNameError ? i18n.translate('Polaris.IndexFilters.UpdateButtons.modal.sameName', {name: savedViewName}) : undefined\",\n                @change=\"handleChange\",\n              )\n  Button(\n    v-else,\n    size=\"micro\",\n    :disabled=\"primaryAction?.disabled || disabled\",\n    @click=\"handleClickSaveButton\",\n  ) {{ buttonText }}\n\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from 'vue';\nimport useI18n from '@/use/useI18n';\nimport { focusFirstFocusableNode } from '@/utilities/focus';\nimport { useIsTouchDevice } from '@/utilities/use-is-touch-device';\nimport type {\n  IndexFiltersPrimaryAction,\n  IndexFiltersCancelAction,\n} from '../../types';\nimport {\n  Modal,\n  ModalSection,\n  TextField,\n  Form,\n  FormLayout,\n  InlineStack,\n  Button,\n} from '@/components';\n\ninterface UpdateIndexFiltersPrimaryAction\n  extends Omit<IndexFiltersPrimaryAction, 'onAction'> {\n  onAction: (value: string) => Promise<void>;\n}\n\nexport interface UpdateButtonsProps {\n  primaryAction?: UpdateIndexFiltersPrimaryAction;\n  cancelAction?: IndexFiltersCancelAction;\n  viewNames: string[];\n  disabled?: boolean;\n}\n\nconst MAX_VIEW_NAME_LENGTH = 40;\n\nconst props = defineProps<UpdateButtonsProps>();\n\nconst i18n = useI18n();\nconst isTouchDevice = useIsTouchDevice();\n\nconst savedViewName = ref<string>('');\nconst savedViewModalOpen = ref<boolean>(false);\nconst container = ref<HTMLDivElement | null>(null);\n\nconst hasSameNameError = computed(() => props.viewNames.some(\n  (name) => name.trim().toLowerCase() === savedViewName.value.trim().toLowerCase(),\n));\nconst isPrimaryActionDisabled = computed(() => {\n  return  hasSameNameError.value ||\n    !savedViewName.value ||\n    props.primaryAction?.loading ||\n    savedViewName.value.length > MAX_VIEW_NAME_LENGTH;\n});\nconst primaryModalAction = computed(() => {\n  return {\n    content: i18n.translate('Polaris.IndexFilters.UpdateButtons.modal.save'),\n    onAction: handlePrimaryAction,\n    disabled: isPrimaryActionDisabled.value,\n  };\n});\nconst secondaryModalActions = computed(() => {\n  return [\n    {\n      onAction: handleCloseModal,\n      content: i18n.translate('Polaris.IndexFilters.UpdateButtons.modal.cancel'),\n    },\n  ];\n});\nconst buttonText = computed(() => {\n  switch (props.primaryAction?.type) {\n    case 'save':\n      return i18n.translate('Polaris.IndexFilters.UpdateButtons.save');\n    case 'save-as':\n    default:\n      return i18n.translate('Polaris.IndexFilters.UpdateButtons.saveAs');\n  }\n});\n\nasync function handleClickSaveButton() {\n  if (props.primaryAction?.type === 'save-as') {\n    handleOpenModal();\n  } else {\n    await props.primaryAction?.onAction('');\n  }\n}\n\nfunction handleOpenModal() {\n  savedViewModalOpen.value = true;\n}\n\nfunction handleCloseModal() {\n  savedViewModalOpen.value = false;\n}\n\nfunction handleChange(value: string) {\n  savedViewName.value = value;\n}\n\nasync function handlePrimaryAction() {\n  if (isPrimaryActionDisabled.value) return;\n  await props.primaryAction?.onAction(savedViewName.value);\n  handleCloseModal();\n}\n\nwatch(\n  () => [savedViewModalOpen.value, isTouchDevice.value],\n  () => {\n    if (!container.value || isTouchDevice.value) return;\n    if (savedViewModalOpen.value) {\n      focusFirstFocusableNode(container.value);\n    }\n  },\n  { flush: 'post' },\n);\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAiFA,MAAM,uBAAuB;;;;;;;;;;AAE7B,UAAM,QAAQ;AAEd,UAAM,OAAO;AACb,UAAM,gBAAgB;AAEhB,UAAA,gBAAgB,IAAY,EAAE;AAC9B,UAAA,qBAAqB,IAAa,KAAK;AACvC,UAAA,YAAY,IAA2B,IAAI;AAEjD,UAAM,mBAAmB,SAAS,MAAM,MAAM,UAAU;AAAA,MACtD,CAAC,SAAS,KAAK,OAAO,kBAAkB,cAAc,MAAM,KAAK,EAAE,YAAY;AAAA,IAAA,CAChF;AACK,UAAA,0BAA0B,SAAS,MAAM;;AACrC,aAAA,iBAAiB,SACvB,CAAC,cAAc,WACf,WAAM,kBAAN,mBAAqB,YACrB,cAAc,MAAM,SAAS;AAAA,IAAA,CAChC;AACK,UAAA,qBAAqB,SAAS,MAAM;AACjC,aAAA;AAAA,QACL,SAAS,KAAK,UAAU,+CAA+C;AAAA,QACvE,UAAU;AAAA,QACV,UAAU,wBAAwB;AAAA,MAAA;AAAA,IACpC,CACD;AACK,UAAA,wBAAwB,SAAS,MAAM;AACpC,aAAA;AAAA,QACL;AAAA,UACE,UAAU;AAAA,UACV,SAAS,KAAK,UAAU,iDAAiD;AAAA,QAC3E;AAAA,MAAA;AAAA,IACF,CACD;AACK,UAAA,aAAa,SAAS,MAAM;;AACxB,eAAA,WAAM,kBAAN,mBAAqB,MAAM;AAAA,QACjC,KAAK;AACI,iBAAA,KAAK,UAAU,yCAAyC;AAAA,QACjE,KAAK;AAAA,QACL;AACS,iBAAA,KAAK,UAAU,2CAA2C;AAAA,MACrE;AAAA,IAAA,CACD;AAED,mBAAe,wBAAwB;;AACjC,YAAA,WAAM,kBAAN,mBAAqB,UAAS,WAAW;AAC3B;MAAA,OACX;AACC,gBAAA,WAAM,kBAAN,mBAAqB,SAAS;AAAA,MACtC;AAAA,IACF;AAEA,aAAS,kBAAkB;AACzB,yBAAmB,QAAQ;AAAA,IAC7B;AAEA,aAAS,mBAAmB;AAC1B,yBAAmB,QAAQ;AAAA,IAC7B;AAEA,aAAS,aAAa,OAAe;AACnC,oBAAc,QAAQ;AAAA,IACxB;AAEA,mBAAe,sBAAsB;;AACnC,UAAI,wBAAwB,MAAO;AACnC,cAAM,WAAM,kBAAN,mBAAqB,SAAS,cAAc;AACjC;IACnB;AAEA;AAAA,MACE,MAAM,CAAC,mBAAmB,OAAO,cAAc,KAAK;AAAA,MACpD,MAAM;AACJ,YAAI,CAAC,UAAU,SAAS,cAAc,MAAO;AAC7C,YAAI,mBAAmB,OAAO;AAC5B,kCAAwB,UAAU,KAAK;AAAA,QACzC;AAAA,MACF;AAAA,MACA,EAAE,OAAO,OAAO;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}