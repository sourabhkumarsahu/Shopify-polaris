{"version":3,"file":"SortButton.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../../src/components/IndexFilters/components/SortButton/SortButton.vue"],"sourcesContent":["<template lang=\"pug\">\nPopover(\n  fluid-content,\n  autofocus-target=\"first-node\",\n  preferred-alignment=\"right\",\n  :active=\"active && !disabled\",\n  :z-index-override=\"disclosureZIndexOverride\",\n  @close=\"handleClose\",\n)\n  template(#activator)\n    Tooltip(\n      preferred-position=\"above\",\n      :content=\"i18n.translate('Polaris.IndexFilters.SortButton.tooltip')\",\n      :hover-delay=\"400\",\n      :z-index-override=\"disclosureZIndexOverride\",\n    )\n      Button(\n        size=\"slim\",\n        :icon=\"SortIcon\",\n        :disabled=\"disabled\",\n        :accessibility-label=\"i18n.translate('Polaris.IndexFilters.SortButton.ariaLabel')\",\n        @click=\"handleClick\",\n      )\n  Box(\n    min-width=\"148px\",\n    padding-inline-start=\"300\",\n    padding-inline-end=\"300\",\n    padding-block-start=\"200\",\n    padding-block-end=\"200\",\n    border-block-end-width=\"025\",\n    border-color=\"border-secondary\",\n  )\n    ChoiceList(\n      v-model=\"model\",\n      :title=\"i18n.translate('Polaris.IndexFilters.SortButton.title')\",\n      :choices=\"choiceListChoices\",\n      @change=\"handleChangeChoiceList\",\n    )\n  Box(\n    padding-inline-start=\"300\",\n    padding-inline-end=\"150\",\n    padding-block-start=\"200\",\n    padding-block-end=\"200\",\n  )\n    DirectionButton(\n      direction=\"asc\",\n      :active=\"selectedDirection === SortButtonDirection.ASC\",\n      :value=\"selectedChoices?.[0]?.value\",\n      @click=\"handleChangeDirection\",\n    ) {{ selectedChoices?.[0]?.directionLabel }}\n    DirectionButton(\n      direction=\"desc\",\n      :active=\"selectedDirection === SortButtonDirection.DESC\",\n      :value=\"selectedChoices?.[1]?.value\",\n      @click=\"handleChangeDirection\",\n    ) {{ selectedChoices?.[1]?.directionLabel }}\n\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, getCurrentInstance, computed, watch, onMounted } from 'vue';\nimport useI18n from '@/use/useI18n';\nimport {\n  Popover,\n  ChoiceList,\n  Tooltip,\n  Box,\n  Button,\n} from '@/components';\nimport { DirectionButton } from './components';\nimport type { ChoiceListProps } from '@/components/ChoiceList/types';\nimport type { SortButtonChoice } from '../../types';\nimport SortIcon from '@icons/SortIcon.svg';\n\ninterface SortButtonProps {\n  choices: SortButtonChoice[];\n  selected: string[];\n  disabled?: boolean;\n  disclosureZIndexOverride?: number;\n}\n\nenum SortButtonDirection {\n  ASC = 'asc',\n  DESC = 'desc',\n}\ntype SortButtonEvents = {\n  'change': [selected: string[]],\n  'change-key': [key: string],\n  'change-direction': [direction: string],\n};\n\nconst props = defineProps<SortButtonProps>();\nconst emits = defineEmits<SortButtonEvents>();\nconst model = defineModel<string[]>();\n\nonMounted(() => {\n  model.value = props.selected;\n});\n\nwatch(\n  () => props.selected,\n  (newVal) => {\n    model.value = newVal;\n  },\n  { immediate: true },\n);\n\nconst i18n = useI18n();\nconst currentInstance = getCurrentInstance();\n\nconst active = ref(false);\nconst selectedValue = computed(() => props.selected[0].split(' '));\n\nconst selectedValueKey = computed(() => selectedValue.value[0]);\nconst selectedDirection = computed(() => selectedValue.value[1]);\n\n const choiceListChoices = computed(() => {\n    const choiceCategories = props.choices.reduce(\n      (acc: ChoiceListProps['choices'], curr) => {\n        const alreadyExists = acc.some((option) => option.label === curr.label);\n        const [, currentValueDirection] = curr.value.split(' ');\n        const isSameDirection = currentValueDirection === selectedDirection.value;\n        if (!alreadyExists) {\n          return [...acc, curr];\n        }\n        if (isSameDirection) {\n          return acc.map((option) => {\n            if (option.label === curr.label) {\n              return curr;\n            }\n            return option;\n          });\n        }\n        return acc;\n      },\n      [],\n    );\n    return choiceCategories;\n  });\n\nconst selectedChoices = computed(() => {\n  return props.choices.filter((choice) => {\n    const [currentKey] = choice.value.split(' ');\n    return currentKey === selectedValueKey.value;\n  });\n});\n\nfunction handleClick() {\n  active.value = !active.value;\n}\n\nfunction handleClose() {\n  active.value = false;\n}\n\nfunction handleChangeChoiceList(value: string[], _name: string) {\n  if (currentInstance?.vnode.props?.onChangeKey) {\n    const [key] = value[0].split(' ');\n    emits('change-key', key);\n  } else {\n    emits('change', value);\n  }3\n}\n\nfunction handleChangeDirection($el: string[]) {\n  if (currentInstance?.vnode.props?.onChangeDirection) {\n    const [, direction] = $el[0].split(' ');\n    emits('change-direction', direction);\n  } else {\n    emits('change', $el);\n  }\n}\n</script>\n"],"names":["_useModel"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA,UAAM,QAAQ;AACd,UAAM,QAAQ;AACR,UAAA,QAAQA,SAAsB,SAAA,YAAA;AAEpC,cAAU,MAAM;AACd,YAAM,QAAQ,MAAM;AAAA,IAAA,CACrB;AAED;AAAA,MACE,MAAM,MAAM;AAAA,MACZ,CAAC,WAAW;AACV,cAAM,QAAQ;AAAA,MAChB;AAAA,MACA,EAAE,WAAW,KAAK;AAAA,IAAA;AAGpB,UAAM,OAAO;AACb,UAAM,kBAAkB;AAElB,UAAA,SAAS,IAAI,KAAK;AAClB,UAAA,gBAAgB,SAAS,MAAM,MAAM,SAAS,CAAC,EAAE,MAAM,GAAG,CAAC;AAEjE,UAAM,mBAAmB,SAAS,MAAM,cAAc,MAAM,CAAC,CAAC;AAC9D,UAAM,oBAAoB,SAAS,MAAM,cAAc,MAAM,CAAC,CAAC;AAExD,UAAA,oBAAoB,SAAS,MAAM;AAChC,YAAA,mBAAmB,MAAM,QAAQ;AAAA,QACrC,CAAC,KAAiC,SAAS;AACnC,gBAAA,gBAAgB,IAAI,KAAK,CAAC,WAAW,OAAO,UAAU,KAAK,KAAK;AACtE,gBAAM,CAAA,EAAG,qBAAqB,IAAI,KAAK,MAAM,MAAM,GAAG;AAChD,gBAAA,kBAAkB,0BAA0B,kBAAkB;AACpE,cAAI,CAAC,eAAe;AACX,mBAAA,CAAC,GAAG,KAAK,IAAI;AAAA,UACtB;AACA,cAAI,iBAAiB;AACZ,mBAAA,IAAI,IAAI,CAAC,WAAW;AACrB,kBAAA,OAAO,UAAU,KAAK,OAAO;AACxB,uBAAA;AAAA,cACT;AACO,qBAAA;AAAA,YAAA,CACR;AAAA,UACH;AACO,iBAAA;AAAA,QACT;AAAA,QACA,CAAC;AAAA,MAAA;AAEI,aAAA;AAAA,IAAA,CACR;AAEG,UAAA,kBAAkB,SAAS,MAAM;AACrC,aAAO,MAAM,QAAQ,OAAO,CAAC,WAAW;AACtC,cAAM,CAAC,UAAU,IAAI,OAAO,MAAM,MAAM,GAAG;AAC3C,eAAO,eAAe,iBAAiB;AAAA,MAAA,CACxC;AAAA,IAAA,CACF;AAED,aAAS,cAAc;AACd,aAAA,QAAQ,CAAC,OAAO;AAAA,IACzB;AAEA,aAAS,cAAc;AACrB,aAAO,QAAQ;AAAA,IACjB;AAES,aAAA,uBAAuB,OAAiB,OAAe;;AAC1D,WAAA,wDAAiB,MAAM,UAAvB,mBAA8B,aAAa;AAC7C,cAAM,CAAC,GAAG,IAAI,MAAM,CAAC,EAAE,MAAM,GAAG;AAChC,cAAM,cAAc,GAAG;AAAA,MAAA,OAClB;AACL,cAAM,UAAU,KAAK;AAAA,MACvB;AAAA,IACF;AAEA,aAAS,sBAAsB,KAAe;;AACxC,WAAA,wDAAiB,MAAM,UAAvB,mBAA8B,mBAAmB;AAC7C,cAAA,CAAA,EAAG,SAAS,IAAI,IAAI,CAAC,EAAE,MAAM,GAAG;AACtC,cAAM,oBAAoB,SAAS;AAAA,MAAA,OAC9B;AACL,cAAM,UAAU,GAAG;AAAA,MACrB;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}