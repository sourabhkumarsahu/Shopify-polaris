{"version":3,"file":"RenameModal.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../../../../src/components/Tabs/components/Tab/components/RenameModal/RenameModal.vue"],"sourcesContent":["<template lang=\"pug\">\nModal(\n  :open=\"open\",\n  :primaryAction=\"primaryAction\",\n  :secondaryActions=\"secondaryActions\",\n  @close=\"emits('close')\",\n)\n  template(#title) {{ i18n.translate('Polaris.Tabs.RenameModal.title') }}\n  ModalSection\n    Form(@submit=\"handlePrimaryAction\")\n      FormLayout\n        div(ref=\"container\")\n          TextField(\n            v-model=\"model\",\n            autoComplete=\"off\",\n            :label=\"i18n.translate('Polaris.Tabs.RenameModal.label')\",\n            :helpText=\"helpText\",\n            :maxLength=\"MAX_VIEW_NAME_LENGTH\",\n            :showCharacterCount=\"true\",\n            :error=\"errorMessage\",\n          )\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch } from 'vue';\nimport useI18n from '@/use/useI18n';\nimport { focusFirstFocusableNode } from '@/utilities/focus';\nimport { Modal, Form, ModalSection, FormLayout, TextField } from '@/components';\n\nexport interface RenameModalProps {\n  open: boolean;\n  isModalLoading?: boolean;\n  name: string;\n  helpText?: string;\n  viewNames?: string[];\n}\n\nconst MAX_VIEW_NAME_LENGTH = 40;\n\nconst props = defineProps<RenameModalProps>();\n\nconst emits = defineEmits<{\n  (e: 'close'): void;\n  (e: 'click-primary-action', value: string): Promise<void>;\n  (e: 'click-secondary-action'): void;\n  (e: 'update:modelValue', value: string): void;\n}>();\n\nconst i18n = useI18n();\nconst container = ref<HTMLDivElement | null>(null);\nconst modalValue = ref<string>('');\n\nconst model = computed({\n  get() {\n    return props.open ? props.name : '';\n  },\n  set(value: string) {\n    modalValue.value = value;\n    emits('update:modelValue', value);\n  },\n});\n\nconst hasSameNameError = computed(() => props.viewNames\n  ?.filter((viewName) => viewName !== props.name)\n  .some(\n    (viewName) =>\n      viewName.trim().toLowerCase() === modalValue.value.trim().toLowerCase(),\n  ),\n);\n\nconst isPrimaryActionDisabled = computed(() =>\n  props.isModalLoading ||\n  hasSameNameError.value ||\n  modalValue.value === props.name ||\n  !modalValue.value ||\n  modalValue.value.length > MAX_VIEW_NAME_LENGTH,\n);\n\nconst primaryAction = computed(() => ({\n  content: i18n.translate('Polaris.Tabs.RenameModal.create'),\n  onAction: handlePrimaryAction,\n  disabled: isPrimaryActionDisabled.value,\n}));\n\nconst secondaryActions = computed(() => [\n  {\n    content: i18n.translate('Polaris.Tabs.RenameModal.cancel'),\n    onAction: handleSecondaryAction,\n  },\n]);\n\nconst errorMessage = computed(() =>\n  hasSameNameError.value\n    ? i18n.translate(\n      'Polaris.Tabs.RenameModal.errors.sameName',\n      { name: modalValue.value },\n    )\n    : undefined,\n);\n\nwatch(\n  () => props.open,\n  (newVal) => {\n    if (!container.value)\n      return;\n\n    if (newVal) {\n      focusFirstFocusableNode(container.value);\n    }\n  },\n  {\n    flush: 'post',\n  },\n);\n\nconst handlePrimaryAction = async () => {\n  if (isPrimaryActionDisabled.value) {\n    return;\n  }\n\n  await emits('click-primary-action', modalValue.value);\n  model.value = '';\n  emits('close');\n}\n\nconst handleSecondaryAction = () => {\n  emits('click-secondary-action');\n  model.value = props.name;\n  emits('close');\n}\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;AAqCA,MAAM,uBAAuB;;;;;;;;;;;;AAE7B,UAAM,QAAQ;AAEd,UAAM,QAAQ;AAOd,UAAM,OAAO;AACP,UAAA,YAAY,IAA2B,IAAI;AAC3C,UAAA,aAAa,IAAY,EAAE;AAEjC,UAAM,QAAQ,SAAS;AAAA,MACrB,MAAM;AACG,eAAA,MAAM,OAAO,MAAM,OAAO;AAAA,MACnC;AAAA,MACA,IAAI,OAAe;AACjB,mBAAW,QAAQ;AACnB,cAAM,qBAAqB,KAAK;AAAA,MAClC;AAAA,IAAA,CACD;AAED,UAAM,mBAAmB;AAAA,MAAS;;AAAM,2BAAM,cAAN,mBACpC,OAAO,CAAC,aAAa,aAAa,MAAM,MACzC;AAAA,UACC,CAAC,aACC,SAAS,OAAO,kBAAkB,WAAW,MAAM,KAAK,EAAE,YAAY;AAAA;AAAA;AAAA,IAC1E;AAGF,UAAM,0BAA0B;AAAA,MAAS,MACvC,MAAM,kBACN,iBAAiB,SACjB,WAAW,UAAU,MAAM,QAC3B,CAAC,WAAW,SACZ,WAAW,MAAM,SAAS;AAAA,IAAA;AAGtB,UAAA,gBAAgB,SAAS,OAAO;AAAA,MACpC,SAAS,KAAK,UAAU,iCAAiC;AAAA,MACzD,UAAU;AAAA,MACV,UAAU,wBAAwB;AAAA,IAClC,EAAA;AAEI,UAAA,mBAAmB,SAAS,MAAM;AAAA,MACtC;AAAA,QACE,SAAS,KAAK,UAAU,iCAAiC;AAAA,QACzD,UAAU;AAAA,MACZ;AAAA,IAAA,CACD;AAED,UAAM,eAAe;AAAA,MAAS,MAC5B,iBAAiB,QACb,KAAK;AAAA,QACL;AAAA,QACA,EAAE,MAAM,WAAW,MAAM;AAAA,MAEzB,IAAA;AAAA,IAAA;AAGN;AAAA,MACE,MAAM,MAAM;AAAA,MACZ,CAAC,WAAW;AACV,YAAI,CAAC,UAAU;AACb;AAEF,YAAI,QAAQ;AACV,kCAAwB,UAAU,KAAK;AAAA,QACzC;AAAA,MACF;AAAA,MACA;AAAA,QACE,OAAO;AAAA,MACT;AAAA,IAAA;AAGF,UAAM,sBAAsB,YAAY;AACtC,UAAI,wBAAwB,OAAO;AACjC;AAAA,MACF;AAEM,YAAA,MAAM,wBAAwB,WAAW,KAAK;AACpD,YAAM,QAAQ;AACd,YAAM,OAAO;AAAA,IAAA;AAGf,UAAM,wBAAwB,MAAM;AAClC,YAAM,wBAAwB;AAC9B,YAAM,QAAQ,MAAM;AACpB,YAAM,OAAO;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}