{"version":3,"file":"CreateViewModal.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../../src/components/Tabs/components/CreateViewModal/CreateViewModal.vue"],"sourcesContent":["<template lang=\"pug\">\nModal(\n  :open=\"open\",\n  :primaryAction=\"primaryAction\",\n  :secondaryActions=\"secondaryActions\",\n  @close=\"emits('close')\",\n)\n  template(#title) {{ i18n.translate('Polaris.Tabs.CreateViewModal.title') }}\n  template(#activator)\n    slot\n  ModalSection\n    Form(@submit=\"handlePrimaryAction\")\n      FormLayout\n        div(ref=\"container\")\n          TextField(\n            autoComplete=\"off\",\n            v-model=\"model\",\n            :label=\"i18n.translate('Polaris.Tabs.CreateViewModal.label')\",\n            :maxLength=\"MAX_VIEW_NAME_LENGTH\",\n            :showCharacterCount=\"true\",\n            :error=\"errorMessage\",\n          )\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch } from 'vue';\nimport type { ComplexAction, VueNode } from '@/utilities/types';\nimport useI18n from '@/use/useI18n';\nimport { useIsTouchDevice } from '@/utilities/use-is-touch-device';\nimport { focusFirstFocusableNode } from '@/utilities/focus';\nimport { Modal, Form, ModalSection, FormLayout, TextField } from '@/components';\n\nexport interface CreateViewModalProps {\n  open: boolean;\n  viewNames: string[];\n}\n\nconst MAX_VIEW_NAME_LENGTH = 40;\n\nconst props = defineProps<CreateViewModalProps>();\n\nconst slots = defineSlots<{\n  /** activator to display in tabs */\n  default?: (_?: VueNode) => any[];\n}>();\n\nconst emits = defineEmits<{\n  (e: 'close'): void;\n  (e: 'click-primary-action', value: string): Promise<boolean>;\n  (e: 'click-secondary-action'): void;\n  (e: 'update:modelValue', value: string): void;\n}>();\n\nconst i18n = useI18n();\nconst isTouchDevice = useIsTouchDevice();\nconst modalValue = ref<string>('');\n\nconst model = computed({\n  get() {\n    return '';\n  },\n  set(value: string) {\n    modalValue.value = value;\n    emits('update:modelValue', value);\n  },\n});\n\nconst loading = ref<boolean>(false);\nconst container = ref<HTMLDivElement | null>(null);\n\nconst hasSameNameError = computed(() => props.viewNames.some(\n  (viewName) => viewName.trim().toLowerCase() === modalValue.value.trim().toLowerCase(),\n));\n\nconst isPrimaryActionDisabled = computed(() =>\n  !modalValue.value ||\n  hasSameNameError.value ||\n  loading.value ||\n  modalValue.value.length > MAX_VIEW_NAME_LENGTH,\n);\n\nconst primaryAction = computed<ComplexAction>(() => {\n  return {\n    content: i18n.translate('Polaris.Tabs.CreateViewModal.create'),\n    disabled: isPrimaryActionDisabled.value,\n    onAction: handlePrimaryAction,\n  };\n});\n\nconst secondaryActions = computed(() => [\n  {\n    content: i18n.translate('Polaris.Tabs.CreateViewModal.cancel'),\n    onAction: handleSecondaryAction,\n  },\n]);\n\nconst errorMessage = computed(() => hasSameNameError.value\n  && i18n.translate('Polaris.Tabs.CreateViewModal.errors.sameName', { name: modalValue.value }),\n);\n\nconst handlePrimaryAction = async () => {\n  if (hasSameNameError.value || isPrimaryActionDisabled.value) {\n    return;\n  }\n\n  loading.value = true;\n  await emits('click-primary-action', modalValue.value);\n  loading.value = false;\n  model.value = '';\n  emits('close');\n}\nconst handleSecondaryAction = () => {\n  emits('click-secondary-action');\n  model.value = '';\n  emits('close');\n}\n\nwatch(\n  () => [props.open, isTouchDevice.value],\n  () => {\n    if (!container.value || isTouchDevice.value) return;\n\n    if (props.open) {\n      focusFirstFocusableNode(container.value);\n      const timeout = setTimeout(() => {\n        if (!container.value) return;\n\n        focusFirstFocusableNode(container.value);\n      }, 50);\n\n      return () => clearTimeout(timeout);\n    }\n  },\n  {\n    flush: 'post',\n  },\n);\n</script>\n"],"names":["_useSlots"],"mappings":";;;;;;;;;;;;;;AAqCA,MAAM,uBAAuB;;;;;;;;;AAE7B,UAAM,QAAQ;AAEAA;AAKd,UAAM,QAAQ;AAOd,UAAM,OAAO;AACb,UAAM,gBAAgB;AAChB,UAAA,aAAa,IAAY,EAAE;AAEjC,UAAM,QAAQ,SAAS;AAAA,MACrB,MAAM;AACG,eAAA;AAAA,MACT;AAAA,MACA,IAAI,OAAe;AACjB,mBAAW,QAAQ;AACnB,cAAM,qBAAqB,KAAK;AAAA,MAClC;AAAA,IAAA,CACD;AAEK,UAAA,UAAU,IAAa,KAAK;AAC5B,UAAA,YAAY,IAA2B,IAAI;AAEjD,UAAM,mBAAmB,SAAS,MAAM,MAAM,UAAU;AAAA,MACtD,CAAC,aAAa,SAAS,OAAO,kBAAkB,WAAW,MAAM,KAAK,EAAE,YAAY;AAAA,IAAA,CACrF;AAED,UAAM,0BAA0B;AAAA,MAAS,MACvC,CAAC,WAAW,SACZ,iBAAiB,SACjB,QAAQ,SACR,WAAW,MAAM,SAAS;AAAA,IAAA;AAGtB,UAAA,gBAAgB,SAAwB,MAAM;AAC3C,aAAA;AAAA,QACL,SAAS,KAAK,UAAU,qCAAqC;AAAA,QAC7D,UAAU,wBAAwB;AAAA,QAClC,UAAU;AAAA,MAAA;AAAA,IACZ,CACD;AAEK,UAAA,mBAAmB,SAAS,MAAM;AAAA,MACtC;AAAA,QACE,SAAS,KAAK,UAAU,qCAAqC;AAAA,QAC7D,UAAU;AAAA,MACZ;AAAA,IAAA,CACD;AAED,UAAM,eAAe;AAAA,MAAS,MAAM,iBAAiB,SAChD,KAAK,UAAU,gDAAgD,EAAE,MAAM,WAAW,OAAO;AAAA,IAAA;AAG9F,UAAM,sBAAsB,YAAY;AAClC,UAAA,iBAAiB,SAAS,wBAAwB,OAAO;AAC3D;AAAA,MACF;AAEA,cAAQ,QAAQ;AACV,YAAA,MAAM,wBAAwB,WAAW,KAAK;AACpD,cAAQ,QAAQ;AAChB,YAAM,QAAQ;AACd,YAAM,OAAO;AAAA,IAAA;AAEf,UAAM,wBAAwB,MAAM;AAClC,YAAM,wBAAwB;AAC9B,YAAM,QAAQ;AACd,YAAM,OAAO;AAAA,IAAA;AAGf;AAAA,MACE,MAAM,CAAC,MAAM,MAAM,cAAc,KAAK;AAAA,MACtC,MAAM;AACJ,YAAI,CAAC,UAAU,SAAS,cAAc,MAAO;AAE7C,YAAI,MAAM,MAAM;AACd,kCAAwB,UAAU,KAAK;AACjC,gBAAA,UAAU,WAAW,MAAM;AAC3B,gBAAA,CAAC,UAAU,MAAO;AAEtB,oCAAwB,UAAU,KAAK;AAAA,aACtC,EAAE;AAEE,iBAAA,MAAM,aAAa,OAAO;AAAA,QACnC;AAAA,MACF;AAAA,MACA;AAAA,QACE,OAAO;AAAA,MACT;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}