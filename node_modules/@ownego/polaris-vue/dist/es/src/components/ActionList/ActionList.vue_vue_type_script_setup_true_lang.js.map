{"version":3,"file":"ActionList.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../src/components/ActionList/ActionList.vue"],"sourcesContent":["<template lang=\"pug\">\ntemplate(v-if=\"(allowFiltering || filterActions) && hasManyActions && isFilterable\")\n  Box(\n    padding=\"200\",\n    :padding-block-end=\"totalFilteredActions > 0 ? '0' : '200'\",\n  )\n    TextField(\n      clear-button,\n      label-hidden,\n      :label=\"filterLabel || i18n.translate('Polaris.ActionList.SearchField.placeholder')\",\n      :placeholder=\"filterLabel || i18n.translate('Polaris.ActionList.SearchField.placeholder')\",\n      autoComplete=\"off\"\n      v-model=\"searchText\"\n      @clear-button-click=\"() => setSearchText('')\"\n    )\n      template(#prefix)\n        Icon(:source=\"SearchIcon\")\nBox(\n  :as=\"HasMultipleSections ? 'ul' : 'div'\",\n  ref=\"actionListRef\",\n  :role=\"elementRole\",\n  :tabindex=\"elementTabIndex\",\n)\n  //- Listeners\n  template(v-if=\"actionRole === 'menuitem'\")\n    KeypressListener(\n      keyEvent=\"keydown\",\n      :keyCode=\"Key.DownArrow\",\n      :handler=\"handleFocusNextItem\",\n    )\n    KeypressListener(\n      keyEvent=\"keydown\",\n      :keyCode=\"Key.UpArrow\"\n      :handler=\"handleFocusPreviousItem\",\n    )\n  //- SectionMarkup\n  template(v-for=\"section, index in filteredSections\")\n    Section(\n      v-if=\"section.items && section.items.length > 0\",\n      :key=\"section.title || index\",\n      :section=\"section\",\n      :hasMultipleSections=\"HasMultipleSections\",\n      :actionRole=\"actionRole\",\n      @action-any-item=\"emits('action-any-item')\",\n    )\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue';\nimport {\n  Box,\n  TextField,\n  Icon,\n  KeypressListener,\n} from '@/components';\nimport { ActionListSection as Section } from './components';\nimport SearchIcon from '@icons/SearchIcon.svg';\nimport {\n  wrapFocusNextFocusableMenuItem,\n  wrapFocusPreviousFocusableMenuItem,\n} from '@/utilities/focus';\nimport useFilterActions from '@/use/useFilterActions';\nimport useI18n from '@/use/useI18n';\nimport { Key } from '@/utilities/types';\nimport type { ActionListItemDescriptor, ActionListSection } from '@/utilities/types';\n\ninterface ActionListProps {\n  /** Collection of actions for list */\n  items?: ActionListItemDescriptor[];\n  /** Collection of sectioned action items */\n  sections?: ActionListSection[];\n  /** Defines a specific role attribute for each action in the list */\n  actionRole?: 'menuitem' | string;\n  /** Allow users to filter items in the list. Will only show if more than 8 items in the list. The item content of every items must be a string for this to work */\n  allowFiltering?: boolean;\n  /** Filter label used as a placeholder in the search field */\n  filterLabel?: string;\n}\n\nconst FILTER_ACTIONS_THRESHOLD = 8;\n\nconst props = defineProps<ActionListProps>();\nconst emits = defineEmits<{\n  /** Callback when any item is clicked or keypressed */\n  'action-any-item': [];\n}>();\n\nconst { filterActions } = useFilterActions();\nconst i18n = useI18n();\n\nconst searchText = ref<string>('');\nconst actionListRef = ref<HTMLElement | null>(null);\n\nconst finalSections = computed(() => {\n  if (props.items) {\n    return [{ items: props.items }, ...(props.sections || [])];\n  }\n\n  if (props.sections) {\n    return props.sections;\n  }\n\n  return [];\n});\nconst isFilterable = computed(() => finalSections.value?.some((section) =>\n  section.items.some((item) => typeof item.content === 'string')));\nconst HasMultipleSections = computed(() => finalSections.value?.length > 1 || false);\nconst elementRole = computed(() => HasMultipleSections.value && props.actionRole === 'menuitem' ? 'menu' : undefined);\nconst elementTabIndex = computed(() => HasMultipleSections.value && props.actionRole === 'menuitem' ? -1 : undefined);\nconst filteredSections = computed(() => {\n  return finalSections.value?.map((section) => ({\n    ...section,\n    items: section.items.filter(({content}) =>\n      typeof content === 'string'\n        ? content?.toLowerCase().includes(searchText.value.toLowerCase())\n        : content,\n    ),\n  }));\n});\nconst totalActions = computed(() =>  finalSections.value?.reduce(\n  (acc: number, section) => acc + section.items.length,\n  0,\n) || 0\n);\nconst totalFilteredActions = computed(() => {\n  const totalSectionItems =\n    filteredSections.value?.reduce(\n      (acc, section) => acc + section.items.length,\n      0,\n    ) || 0;\n\n  return totalSectionItems;\n});\n\nconst hasManyActions = computed(() => totalActions.value >= FILTER_ACTIONS_THRESHOLD);\n\nconst setSearchText = (value: string) => {\n  searchText.value = value;\n};\n\nconst handleFocusPreviousItem = (evt: KeyboardEvent) => {\n  evt.preventDefault();\n  if (actionListRef.value && evt.target) {\n    if (actionListRef.value.contains(evt.target as HTMLElement)) {\n      wrapFocusPreviousFocusableMenuItem(\n        actionListRef.value,\n        evt.target as HTMLElement,\n      );\n    }\n  }\n};\n\nconst handleFocusNextItem = (evt: KeyboardEvent) => {\n  evt.preventDefault();\n  if (actionListRef.value && evt.target) {\n    if (actionListRef.value.contains(evt.target as HTMLElement)) {\n      wrapFocusNextFocusableMenuItem(\n        actionListRef.value,\n        evt.target as HTMLElement,\n      );\n    }\n  }\n};\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AA+EA,MAAM,2BAA2B;;;;;;;;;;;;AAEjC,UAAM,QAAQ;AACd,UAAM,QAAQ;AAKR,UAAA,EAAE,kBAAkB;AAC1B,UAAM,OAAO;AAEP,UAAA,aAAa,IAAY,EAAE;AAC3B,UAAA,gBAAgB,IAAwB,IAAI;AAE5C,UAAA,gBAAgB,SAAS,MAAM;AACnC,UAAI,MAAM,OAAO;AACR,eAAA,CAAC,EAAE,OAAO,MAAM,SAAS,GAAI,MAAM,YAAY,CAAA,CAAG;AAAA,MAC3D;AAEA,UAAI,MAAM,UAAU;AAClB,eAAO,MAAM;AAAA,MACf;AAEA,aAAO;IAAC,CACT;AACD,UAAM,eAAe,SAAS,MAAM;;AAAA,iCAAc,UAAd,mBAAqB,KAAK,CAAC,YAC7D,QAAQ,MAAM,KAAK,CAAC,SAAS,OAAO,KAAK,YAAY,QAAQ;AAAA,KAAE;AACjE,UAAM,sBAAsB,SAAS;;AAAM,kCAAc,UAAd,mBAAqB,UAAS,KAAK;AAAA,KAAK;AAC7E,UAAA,cAAc,SAAS,MAAM,oBAAoB,SAAS,MAAM,eAAe,aAAa,SAAS,MAAS;AAC9G,UAAA,kBAAkB,SAAS,MAAM,oBAAoB,SAAS,MAAM,eAAe,aAAa,KAAK,MAAS;AAC9G,UAAA,mBAAmB,SAAS,MAAM;;AACtC,cAAO,mBAAc,UAAd,mBAAqB,IAAI,CAAC,aAAa;AAAA,QAC5C,GAAG;AAAA,QACH,OAAO,QAAQ,MAAM;AAAA,UAAO,CAAC,EAAC,QAAO,MACnC,OAAO,YAAY,WACf,mCAAS,cAAc,SAAS,WAAW,MAAM,YAAA,KACjD;AAAA,QACN;AAAA,MACA;AAAA,IAAA,CACH;AACD,UAAM,eAAe;AAAA,MAAS,MAAO;;AAAA,oCAAc,UAAd,mBAAqB;AAAA,UACxD,CAAC,KAAa,YAAY,MAAM,QAAQ,MAAM;AAAA,UAC9C;AAAA,cACG;AAAA;AAAA,IAAA;AAEC,UAAA,uBAAuB,SAAS,MAAM;;AACpC,YAAA,sBACJ,sBAAiB,UAAjB,mBAAwB;AAAA,QACtB,CAAC,KAAK,YAAY,MAAM,QAAQ,MAAM;AAAA,QACtC;AAAA,YACG;AAEA,aAAA;AAAA,IAAA,CACR;AAED,UAAM,iBAAiB,SAAS,MAAM,aAAa,SAAS,wBAAwB;AAE9E,UAAA,gBAAgB,CAAC,UAAkB;AACvC,iBAAW,QAAQ;AAAA,IAAA;AAGf,UAAA,0BAA0B,CAAC,QAAuB;AACtD,UAAI,eAAe;AACf,UAAA,cAAc,SAAS,IAAI,QAAQ;AACrC,YAAI,cAAc,MAAM,SAAS,IAAI,MAAqB,GAAG;AAC3D;AAAA,YACE,cAAc;AAAA,YACd,IAAI;AAAA,UAAA;AAAA,QAER;AAAA,MACF;AAAA,IAAA;AAGI,UAAA,sBAAsB,CAAC,QAAuB;AAClD,UAAI,eAAe;AACf,UAAA,cAAc,SAAS,IAAI,QAAQ;AACrC,YAAI,cAAc,MAAM,SAAS,IAAI,MAAqB,GAAG;AAC3D;AAAA,YACE,cAAc;AAAA,YACd,IAAI;AAAA,UAAA;AAAA,QAER;AAAA,MACF;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}